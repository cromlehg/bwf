@(webSocketUrl: String)(implicit flash: Flash, messages: Messages, ac: controllers.AppContext, req: play.api.mvc.RequestHeader)

@app.common.main("chat") {

	<style type="text/css">
		.wrap {
			min-height: 100%;
			height: 100%;
			margin: 0 auto -60px;
		}

		.footer {
			height: 60px;
		}
	</style>

} {
  @base.common.components.container() {

		<div class="container">
			<!-- header: status, room title -->
			<div class="row">
				<div class="col-lg-12" id="chat-status">
					Waiting for connection...
				</div>
			</div>

			<!-- content: conversation -->
			<div class="row">
				<div class="col-lg-12">
					<ul class="list-unstyled" id="chat-messages">

					</ul>
				</div>
			</div>

			<!-- panel: tools to send message -->
			<div class="row">

				<div class="col-lg-10">
					<input id="chat-sending-message" placeholder="Type Here" type="text"
					autofocus
					autocomplete="off" spellcheck="false" autocorrect="off"
					class="form-control" />
				</div>

				<div class="col-lg-2">
					<button id="chat-send" type="submit" class="btn btn-primary btn-block">Send</button>
				</div>

			</div>
		</div>

          
  }
} {

	<script type="text/javascript" src="/assets/javascripts/chat.js"></script>
	<script type="text/javascript">
		$( document ).ready(function() {

			var $chatMessages = $("#chat-messages");

			var $chatSendingMessage = $("#chat-sending-message");

			var $chatSend = $("#chat-send");

			var $chatStatus = $("#chat-status");

			initChat("@webSocketUrl", function(msg, userLogin, msgTime) {

				var appendedHtml = "" +
				"<li class='media'>" +
					"<div class='media-body'>" +
						msg +
						"<br>" +
						"<small class='text-muted'>" + userLogin + " | " + msgTime + "</small>" +
				  "</div>" +
				"</li>";

				$chatMessages.append(appendedHtml);
			}, function(wsStatus) {
				$chatStatus.html(wsStatus);
			}, function(sendCallback) {

				var send = function() {
					var text = $chatSendingMessage.val();
					$chatSendingMessage.val("");
					sendCallback(text);
				};

				$chatSend.on('click', send);

				$chatSendingMessage.keypress(function(event) {
					var keycode = (event.keyCode ? event.keyCode : event.which);
					if (keycode == '13') {
						send();
					}
				});

			}, function() {
				$chatSend.prop("disabled", true);
			}, function() {
				$chatSend.prop("disabled", false);
			});
		});
	</script>

}
